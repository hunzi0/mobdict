import argparse

import requests

areadict = {'山东': '1,11,12,18,41,42,43,44,45,46,47,48,49,50,51,52,63', '济南': '1', '淄博': '11', '烟台': '12',
            '潍坊': '18', '滨州': '41', '东营': '42', '临沂': '43', '日照': '44', '枣庄': '45', '威海': '46',
            '青岛': '47',
            '聊城': '48', '德州': '49', '泰安': '50', '济宁': '51', '菏泽': '52', '莱芜': '63',
            '江苏': '2,7,14,74,75,76,77,78,79,80,86,87,88', '常州': '2', '南京': '7', '无锡': '14', '镇江': '74',
            '连云港': '75', '盐城': '76', '宿迁': '77', '徐州': '78', '南通': '79', '淮安': '80', '扬州': '86',
            '泰州': '87', '苏州': '88', '安徽': '3,71,72,73,85,217,218,219,220,221,222,223,226,227,228,246,371',
            '合肥': '3', '蚌埠': '71', '芜湖': '72', '淮南': '73', '阜阳': '85', '马鞍山': '217', '宣城': '218',
            '安庆': '219', '滁州': '220', '池州': '221', '黄山': '222', '铜陵': '223', '宿州': '226', '六安': '227',
            '淮北': '228', '亳州': '246,371',
            '四川': '4,5,64,65,66,67,68,69,70,124,125,126,127,128,172,307,318,319,320,321,322,342', '宜宾': '4',
            '自贡': '5', '西昌': '64', '攀枝花': '65', '南充': '66', '遂宁': '67', '达州': '68', '泸州': '69',
            '内江': '70',
            '乐山': '124', '眉山': '125', '德阳': '126', '广元': '127', '绵阳': '128', '成都': '172', '资阳': '307',
            '甘孜': '318', '阿坝': '319', '巴中': '320', '广安': '321', '雅安': '322', '凉山': '342',
            '陕西': '6,179,180,181,182,183,184,248,308,311,349', '西安': '6', '渭南': '179', '咸阳': '180',
            '汉中': '181',
            '宝鸡': '182', '铜川': '183', '延安': '184', '榆林': '248', '商洛': '308', '安康': '311', '商州': '349',
            '湖北': '8,17,272,273,286,287,288,290,291,292,293,294,295,300,348,366,368,369', '武汉': '8', '荆门': '17',
            '宜昌': '272', '恩施': '273', '黄石': '286', '鄂州': '287', '黄冈': '288', '孝感': '290', '随州': 291,
            '襄阳': '292', '十堰': '293', '荆州': '294', '仙桃': '295', '咸宁': '300', '江汉': '348,366',
            '神农架': '368',
            '潜江': '369', '北京': '9,9', '天津': '10,10', '上海': '13,13',
            '广东': '15,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,129,130', '广州': '15',
            '汕头': '95', '汕尾': '96', '揭阳': '97', '梅州': '98', '河源': '99', '潮州': '100', '清远': '101',
            '韶关': '102', '云浮': '103', '深圳': '104', '中山': '105', '肇庆': '106', '湛江': '107', '阳江': '108',
            '茂名': '109', '珠海': '110', '惠州': '111', '江门': '112', '佛山': '129', '东莞': '130',
            '广西': '16,113,114,115,116,117,131,132,133,134,232,233,333,363', '南宁': '16', '柳州': '113',
            '桂林': '114',
            '玉林': '115', '梧州': '116', '北海': '117', '防城港': '131', '百色': '132', '钦州': '133', '河池': '134',
            '贵港': '232', '贺州': '233', '来宾': '333', '崇左': '363', '浙江': '19,22,55,56,57,58,59,60,61,62,81',
            '温州': '19', '宁波': '22', '嘉兴': '55', '湖州': '56', '舟山': '57', '绍兴': '58', '衢州': '59',
            '金华': '60',
            '台州': '61', '丽水': '62', '杭州': '81',
            '河南': '20,148,149,150,151,152,153,154,243,249,257,258,259,280,281,282,305,306,356', '郑州': '20',
            '洛阳': '148', '安阳': '149', '开封': '150', '焦作': '151', '新乡': '152', '许昌': '153', '漯河': '154',
            '平顶山': '243', '济源': '249', '濮阳': '257', '三门峡': '258', '鹤壁': '259', '信阳': '280,356',
            '驻马店': '281', '周口': '282', '商丘': '305', '南阳': '306',
            '甘肃': '21,229,230,231,250,251,252,253,283,284,285,326,327,331', '兰州': '21', '嘉峪关': '229',
            '张掖': '230',
            '武威': '231', '白银': '250', '酒泉': '251', '定西': '252', '临夏': '253', '庆阳': '283', '天水': '284',
            '平凉': '285', '甘南': '326', '陇南': '327', '金昌': '331',
            '吉林': '23,190,191,192,193,194,195,196,197,346,355,357,196', '长春': '23', '四平': '190', '辽源': '191',
            '松原': '192', '白城': '193', '白山': '194', '延边': '195', '通化': '197', '梅河口': '346', '延吉': '355',
            '珲春': '357', '辽宁': '24,25,26,54,173,174,175,176,177,178,198,199,200,201', '本溪': '24', '营口': '25',
            '大连': '26', '沈阳': '54', '辽阳': '173', '阜新': '174', '盘锦': '175', '朝阳': '176', '锦州': '177',
            '铁岭': '178', '丹东': '198', '抚顺': '199', '葫芦岛': '200', '鞍山': '201',
            '内蒙古': '27,202,203,204,205,206,234,235,236,260,261,324,325,341,347,350,365', '包头': '27',
            '呼和浩特': '202',
            '乌兰察布': '203', '鄂尔多斯': '204', '巴彦淖尔': '205', '乌海': '206', '海拉尔': '234', '通辽': '235',
            '赤峰': '236', '兴安盟': '260', '锡林郭勒盟': '261', '阿拉善盟': '324', '锡林浩特': '325',
            '呼伦贝尔': '341',
            '乌兰浩特': '347', '临河': '350', '集宁': '365',
            '新疆': '28,207,254,255,256,265,266,267,268,269,270,271,314,315,316,317,362,370', '乌鲁木齐': '28',
            '昌吉': '207', '石河子': '254', '库尔勒': '255', '喀什': '256', '吐鲁番': '265', '哈密': '266',
            '阿克苏': '267',
            '奎屯': '268', '博乐': '269', '伊犁': '270', '克拉玛依': '271', '克孜勒苏': '314', '和田': '315',
            '塔城': '316',
            '阿勒泰': '317', '巴音郭楞': '362', '博尔塔拉': '370',
            '黑龙江': '29,30,208,209,210,211,212,213,214,215,216,312,313', '佳木斯': '29', '哈尔滨': '30',
            '齐齐哈尔': '208', '牡丹江': '209', '大庆': '210', '绥化': '211', '黑河': '212', '鸡西': '213',
            '七台河': '214',
            '鹤岗': '215', '双鸭山': '216', '伊春': '312', '大兴安岭': '313', '福建': '31,82,83,84,89,90,91,92,93',
            '福州': '31', '莆田': '82', '厦门': '83', '漳州': '84', '泉州': '89', '三明': '90', '宁德': '91',
            '南平': '92',
            '龙岩': '93', '河北': '32,33,34,35,36,37,38,39,40,244,245,367', '保定': '32', '唐山': '33', '秦皇岛': '34',
            '廊坊': '35', '沧州': '36', '邢台': '37', '邯郸': '38', '衡水': '39', '石家庄': '40', '张家口': '244',
            '承德': '245', '雄安': '367', '重庆': '53,351,352,353,53', '黔江': '351', '万州': '352', '涪陵': '353',
            '海南': '94,364,158', '海口': '94', '三亚': '364', '江西': '118,119,120,121,122,123,137,247,262,263,264',
            '南昌': '118', '鹰潭': '119', '上饶': '120', '宜春': '121', '新余': '122', '萍乡': '123', '九江': '137',
            '赣州': '247', '景德镇': '262', '吉安': '263', '抚州': '264',
            '山西': '135,136,167,168,169,170,171,277,278,279,303', '太原': '135', '晋中': '136', '运城': '167',
            '临汾': '168', '大同': '169', '晋城': '170', '长治': '171', '忻州': '277', '朔州': '278', '吕梁': '279',
            '阳泉': '303', '湖南': '138,139,140,141,142,143,144,145,146,147,289,301,302,304,361', '岳阳': '138',
            '长沙': '139', '湘潭': '140', '株洲': '141', '衡阳': '142', '郴州': '143', '常德': '144', '益阳': '145',
            '娄底': '146', '邵阳': '147', '怀化': '289', '张家界': '301', '永州': '302', '吉首': '304', '湘西': '361',
            '青海': '155,156,157,158,159,323,328,329,330,358,359,360', '格尔木': '155', '西宁': '156', '海东': '157',
            '海北': '159', '海西': '323', '玉树': '328', '果洛': '329', '黄南': '330', '海晏': '358', '共和': '359',
            '德令哈': '360', '贵州': '160,161,162,237,238,239,240,241,242,343,344,345', '贵阳': '160', '遵义': '161',
            '安顺': '162', '铜仁': '237', '黔东南': '238', '黔南': '239', '六盘水': '240', '黔西南': '241',
            '毕节': '242',
            '都匀': '343', '凯里': '344', '兴义': '345', '宁夏': '163,164,165,166,332', '石嘴山': '163', '吴忠': '164',
            '固原': '165', '银川': '166', '中卫': '332',
            '云南': '185,0.186,187,188,189,224,225,274,275,276,296,297,298,299,309,310,354', '红河': '185',
            '楚雄': 0.186,
            '曲靖': '187', '玉溪': '188', '昆明': '189', '大理': '224', '丽江': '225', '文山': '274', '普洱': '275',
            '保山': '276', '临沧': '296', '怒江': '297', '德宏': '298', '西双版纳': '299', '迪庆': '309', '昭通': '310',
            '思茅': '354', '西藏': '334,335,336,337,338,339,340', '拉萨': '334', '日喀则': '335', '山南': '336',
            '林芝': '337', '昌都': '338', '那曲': '339', '阿里': '340'}


def mobiles(num, area, segment):
    url = "https://api.uutool.cn:443/phone/generate_batch"
    headers = {"Accept": "*/*",
               "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Edg/113.0.1774.42",
               "Sec-Fetch-Site": "cross-site", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Dest": "empty",
               "Accept-Encoding": "gzip, deflate", "Accept-Language": "zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",
               "Content-Type": "application/x-www-form-urlencoded"}
    data = "phone_num=%d&area=%s&segment=%s" % (num, area, segment)
    try:
        r = requests.post(url, headers=headers, data=data).json()
        if 'data' not in r:
            return 1, r['error']
        mobile = str(r['data']['rows'])[1:-1]
        mobile = mobile.replace("'", '')
        mobile = mobile.replace(" ", '')
        return 0, mobile
    except:
        return 2, "请求异常"


def areas(area):
    if area == '':
        return area
    area = str(area).split(',')
    a = ''
    for i in area:
        if i not in areadict.keys():
            print('[-] 未存储该地区数据，自动跳过该地区并继续查询')
            continue
        a += str(areadict[i]) + ','

    return a[:-1]


def main():
    parser = argparse.ArgumentParser(description='手机号生成脚本')
    parser.add_argument(
        "-n",
        "--num",
        type=int,
        help="生成手机号数量，最多2w条，默认2w条",
        default=20000,
        metavar='')
    parser.add_argument(
        "-a",
        "--area",
        type=str,
        help="地区，逗号间隔，默认所有地区",
        default='',
        metavar='')
    parser.add_argument(
        "-s",
        "--segment",
        type=str,
        help="手机号前三位，逗号间隔，默认所有开头",
        default='134,135,136,137,138,139,147,150,151,152,157,158,159,165,172,178,182,183,184,187,188,198,130,131,132,145,155,156,166,171,175,176,185,186,133,149,153,173,177,180,181,189,199',
        metavar='')
    args = parser.parse_args()
    num = args.num
    area = args.area
    segment = args.segment
    print('[+] 正在生成文件mobile.txt')

    area = areas(area)

    mob = mobiles(num, area, segment)
    if mob[0] == 1:
        print('[-] ' + mob[1])
        return
    elif mob[0] == 2:
        print('[*] ' + mob[1])
        return
    mob = str(mob[1]).replace(',', '\n')
    f = open('mobile.txt', 'w')
    f.write(mob)
    f.close()
    print('[+] 已生成文件mobile.txt')


if __name__ == '__main__':
    main()
